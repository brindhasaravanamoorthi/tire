<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tyre Damage level detection</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-zinc-900 text-white p-12 flex flex-col justify-center items-center">
    <div class="flex flex-row justify-center items-center mb-4">
        <img
        class="animate-spin drop-shadow-[0_0_20px_rgba(225,225,225,1),1] w-16 h-16 drop-shadow-[0_0_20px_rgba(225,225,225,0.8),1]"
        src="https://imgs.search.brave.com/2XlS-80MXSxYnDVk7g_Olp_m_2pLNBwfEeW0TqDxsT0/rs:fit:860:0:0/g:ce/aHR0cHM6Ly93d3cu/cG5nbWFydC5jb20v/ZmlsZXMvOS9UeXJl/LVBORy1QaG90b3Mu/cG5n" alt=""
        >
        <h1 class="text-2xl m-2 font-bold mb-4 ">
            TYRE DAMAGE DETECTION
        </h1>
        <img
        class="animate-spin w-16 h-16 drop-shadow-[0_0_20px_rgba(225,225,225,0.8),1]"
        src="https://imgs.search.brave.com/2XlS-80MXSxYnDVk7g_Olp_m_2pLNBwfEeW0TqDxsT0/rs:fit:860:0:0/g:ce/aHR0cHM6Ly93d3cu/cG5nbWFydC5jb20v/ZmlsZXMvOS9UeXJl/LVBORy1QaG90b3Mu/cG5n" alt=""
        >
    </div>
    

        <div>
            <img
            class="md:w-[800px] w-[450px] h-[300px] md:h-[500px] bg-gray-800 rounded-xl border-red-500 border-2 object-cover"
            id="video_feed" src="{{ url_for('video_feed') }}" width="640" height="480" />
        </div>
        <div id="detected_classes"></div>
        <ul id="detected_classes">
          <!-- Detected classes will be dynamically inserted here -->
      </ul>
      
    <div class="flex flex-row justify-center w-full mt-16">
        <div>
            <table class="mt-4 p-2 border w-full bg-gray-800">
                <thead class="text-red-500">
                  <tr>
                    <th class="p-2">Term</th>
                    <th class="p-2">Description</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="border p-2" >Bead</td>
                    <td class="border p-2" >The part of the tire that secures it to the rim of the wheel.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Damage</td>
                    <td class="border p-2" >This is a general term indicating some form of harm has been done to the tire.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Crack</td>
                    <td class="border p-2" >A long, narrow opening in the tire's material, typically caused by stress or impact.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Debris</td>
                    <td class="border p-2" >Pieces of foreign material lodged in the tire, potentially causing punctures or cuts.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Ground</td>
                    <td class="border p-2" >Refers to damage caused by contact with the road surface, possibly due to wear, scraping, or other factors.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Normal</td>
                    <td class="border p-2" >This likely indicates the absence of any damage or an area of the tire that appears to be in good condition.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Outside</td>
                    <td class="border p-2" >The exterior surface of the tire that is exposed during normal use.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Sidewall</td>
                    <td class="border p-2" >The vertical wall of the tire between the tread (the part that makes contact with the road) and the bead.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Cuts</td>
                    <td class="border p-2" >Sharp separations in the tire's material, potentially affecting its integrity.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Side</td>
                    <td class="border p-2" >This could refer to either the left or right sidewall of the tire.</td>
                  </tr>
                  <tr>
                    <td class="border p-2" >Side_cut</td>
                    <td class="border p-2" >A specific type of cut located on the sidewall of the tire.</td>
                  </tr>
                </tbody>
              </table>
        </div>
        <div class="ml-5 mt-4 p-2">
            <table border="1" class="w-1/3 bg-gray-800">
                <tr class="border p-2">
                    <th class="p-2 text-red-500">Class Name</th>
                </tr>
                {% for class_name in classnames %}
                <tr class="border p-2">
                    <td class="p-2">{{ class_name }}</td>
                </tr>
                {% endfor %}
            </table>
        </div>
    </div>

    
      
    

    
    <script>
      // Function to fetch data from the Flask server and update the HTML content
      function updateDetectedClasses() {
          fetch('/output')
              .then(response => response.text())
              .then(data => {
                  // Parse the JSON data
                  const detectedClasses = JSON.parse(data);

                  // Clear the previous content
                  document.getElementById('detected_classes').innerHTML = '';

                  // Update the content with detected classes
                  detectedClasses.forEach(className => {
                      const listItem = document.createElement('li');
                      listItem.textContent = className;
                      document.getElementById('detected_classes').appendChild(listItem);
                  });
              });
      }

      // Update the detected classes every second
      setInterval(updateDetectedClasses, 1000);
  </script>

    <script>
        var detectedClassesElement = document.getElementById('detected_classes');

        var eventSource = new EventSource('/video_feed');
        eventSource.onmessage = function(event) {
            var data = JSON.parse(event.data);
            detectedClassesElement.innerText = 'Detected Classes: ' + data.join(', ');
        };
    </script>
</body>
</html>
